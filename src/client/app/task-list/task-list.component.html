<div fxFlexFill fxLayout="row" fxLayoutAlign="center center" *ngIf="!readyToDisplay">
  <md-spinner class="main-spinner"></md-spinner>
</div>
<div fxLayout="row" fxLayoutAlign="center center" *ngIf="(!tasks || tasks.length === 0) && readyToDisplay" class="no-tasks"
     [@shortEnterAnimation]>
  <p>No open tasks!</p>
</div>
<div fxFlex *ngIf="readyToDisplay" [@shortEnterAnimation]>
  <div id="task-list" fxLayout="column">
    <div class="item-wrapper" *ngFor="let task of tasks; let index = index">
      <div class="item" fxLayout="row" fxLayoutAlign="space-between" *ngIf="task.fields.votingWasNotCreated || task.fields.isOpen"
           [ngClass]="{'item-border-top': index === calculateFirstVisibleItemIndex()}">
        <div class="left-side" fxLayout="row" fxLayoutAlign="center center">
          <img *ngIf="task.fields.issuetype.name === 'Bug'" class="first" src="../../assets/images/bug-icon.svg" alt="">
          <img *ngIf="task.fields.issuetype.name === 'Task'" class="first" src="../../assets/images/task-icon.svg" alt="">
          <img *ngIf="task.fields.issuetype.name === 'Subtask'" class="first" src="../../assets/images/subtask-icon.svg" alt="">
          <img *ngIf="task.fields.issuetype.name === 'Story'" class="first" src="../../assets/images/story-icon.svg" alt="">
          <img *ngIf="task.fields.issuetype.name === 'Epic'" class="first" src="../../assets/images/epic-icon.svg" alt="">
          <p>{{task.fields.summary}}</p>
          <div class="assignee-cloud" fxLayout="row" fxLayoutAlign="center center" *ngIf="task.fields.assignee && task.fields.assignee.displayName">
            {{task.fields.assignee.displayName}}
          </div>
        </div>
        <div class="right-side" fxLayout="row" fxLayoutAlign="center center">
          <h3>{{task.key}}</h3>
          <div class="story-points-cloud" fxLayout="row" fxLayoutAlign="center center">
            <md-spinner *ngIf="task.storyPointsLoading"></md-spinner>
            <span *ngIf="!task.storyPointsLoading" [@alternativeControlFlashAnimation]="task.flashAnimation">
            {{countStoryPoints(task.fields.votesCount, task.fields.votesSum)}}
          </span>
          </div>
          <div class="story-points-user-choice-cloud unselectable pointer" fxLayout="row" fxLayoutAlign="center center"
               [mdMenuTriggerFor]="storyPointsUserChoiceMenu">
            <md-spinner *ngIf="task.votingLoading"></md-spinner>
            <span *ngIf="!task.fields.votesUserChoice && !task.votingLoading" [@alternativeControlFlashAnimation]="task.flashAnimation">Vote</span>
            <span *ngIf="task.fields.votesUserChoice && !task.votingLoading" [@alternativeControlFlashAnimation]="task.flashAnimation">
            {{task.fields.votesUserChoice}}
          </span>
            <i *ngIf="!task.votingLoading" class="fa fa-caret-down" aria-hidden="true" [@alternativeControlFlashAnimation]="task.flashAnimation"></i>
          </div>
          <md-menu #storyPointsUserChoiceMenu="mdMenu">
            <button md-menu-item *ngFor="let option of storyPointsOptions" (click)="changeStoryPointsUserChoice(task, task.key, option)">
              {{option}}
            </button>
          </md-menu>
        </div>
      </div>
    </div>
  </div>
</div>
